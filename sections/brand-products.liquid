<section class="brand-section" data-vendor-handle="{{ section.settings.vendor_handle | handleize }}">
  <div class="brand-section__intro">
    <h1>{{ section.settings.title }}</h1>
    <div class="brand-section__content">{{ section.settings.content }}</div>
  </div>
  <div class="brand-section__products" data-brand-products>
    {% assign all_collection = collections['all'] %}
    {% if all_collection != blank %}
      {% assign vendor_products = all_collection.products | where: 'vendor', section.settings.vendor_name %}
      {% if vendor_products.size > 0 %}
        {% for product in vendor_products %}
          {% render 'product-card', product: product %}
        {% endfor %}
      {% else %}
        {% for product in all_collection.products %}
          {% render 'product-card', product: product %}
        {% endfor %}
      {% endif %}
    {% else %}
      <p class="brand-section__empty">Añade productos a la colección "Todos" para mostrar esta marca.</p>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Productos por marca",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Título",
      "default": "Marca destacada"
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "Descripción",
      "default": "<p>Descubre los equipos y refacciones disponibles de esta marca.</p>"
    },
    {
      "type": "text",
      "id": "vendor_name",
      "label": "Nombre de la marca (debe coincidir con Vendor)",
      "default": "Supreme"
    },
    {
      "type": "text",
      "id": "vendor_handle",
      "label": "Handle de la marca (para filtrado JS)",
      "default": "supreme"
    }
  ],
  "presets": [
    {
      "name": "Productos de marca"
    }
  ]
}
{% endschema %}
