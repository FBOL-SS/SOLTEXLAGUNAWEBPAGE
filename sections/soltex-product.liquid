<style>
  .shopdev .product-page-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 20px;
  }

  .shopdev .product-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 40px;
  }

  @media (min-width: 768px) {
    .shopdev .product-grid {
      grid-template-columns: 1fr 1fr;
    }
  }

  .shopdev .main-image-container {
    position: relative;
    width: 100%;
    padding-bottom: 100%;
    background-color: #f4f4f4;
    border-radius: 6px;
    overflow: hidden;
    cursor: zoom-in;
  }

  .shopdev .main-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
    user-select: none;
    -webkit-user-drag: none;
  }

  .shopdev .main-image-container:hover .main-image {
    transform: scale(1.1);
  }

  .shopdev .thumbnail-container {
    display: flex;
    gap: 12px;
    margin-top: 16px;
    overflow-x: auto;
    padding-bottom: 8px;
  }

  .shopdev .thumbnail-container::-webkit-scrollbar {
    height: 4px;
  }

  .shopdev .thumbnail-container::-webkit-scrollbar-track {
    background: #f4f4f4;
    border-radius: 2px;
  }

  .shopdev .thumbnail-container::-webkit-scrollbar-thumb {
    background: #0d1b2a;
    border-radius: 2px;
  }

  .shopdev .thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border-radius: 6px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s ease;
  }

  .shopdev .thumbnail.active {
    border-color: #0d1b2a;
  }

  .shopdev .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    user-select: none;
    -webkit-user-drag: none;
  }

  .shopdev .product-info h2 {
    font-size: 32px;
    font-weight: 700;
    color: #0d1b2a;
    margin-bottom: 12px;
    line-height: 1.2;
  }

  .shopdev .vendor {
    font-size: 14px;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 16px;
  }

  .shopdev .sku {
    font-size: 14px;
    color: #666;
    margin-bottom: 16px;
  }

  .shopdev .sku-label {
    font-weight: 600;
    color: #0d1b2a;
  }

  .shopdev .price {
    font-size: 28px;
    font-weight: 700;
    color: #0d1b2a;
    margin-bottom: 16px;
  }

  .shopdev .availability {
    display: inline-block;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 24px;
  }

  .shopdev .availability.in-stock {
    background-color: #e8f5e9;
    color: #2e7d32;
  }

  .shopdev .availability.out-of-stock {
    background-color: #ffebee;
    color: #c62828;
  }

  .shopdev .quantity-selector {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 20px;
  }

  .shopdev .quantity-label {
    font-size: 14px;
    font-weight: 600;
    color: #0d1b2a;
  }

  .shopdev .quantity-controls {
    display: flex;
    align-items: center;
    border: 2px solid #0d1b2a;
    border-radius: 6px;
    overflow: hidden;
  }

  .shopdev .quantity-btn {
    width: 40px;
    height: 40px;
    background-color: #ffffff;
    border: none;
    color: #0d1b2a;
    font-size: 18px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }

  .shopdev .quantity-btn:hover {
    background-color: #f4f4f4;
  }

  .shopdev .quantity-input {
    width: 60px;
    height: 40px;
    border: none;
    border-left: 1px solid #0d1b2a;
    border-right: 1px solid #0d1b2a;
    text-align: center;
    font-size: 16px;
    font-weight: 600;
    color: #0d1b2a;
  }

  .shopdev .add-to-cart-btn {
    width: 100%;
    padding: 16px 32px;
    background-color: #0d1b2a;
    color: #ffffff;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
    margin-bottom: 12px;
  }

  .shopdev .add-to-cart-btn:hover {
    background-color: #1a2f47;
    transform: translateY(-2px);
  }

  .shopdev .add-to-cart-btn:disabled {
    background-color: #ccc;
    cursor: not-allowed;
    transform: none;
  }

  .shopdev .button-group {
    display: flex;
    gap: 12px;
    margin-bottom: 12px;
  }

  .shopdev .button-group .add-to-cart-btn,
  .shopdev .button-group .buy-now-btn {
    flex: 1;
    margin-bottom: 0;
  }

  .shopdev .buy-now-btn {
    width: 100%;
    padding: 16px 32px;
    background-color: #ffffff;
    color: #0d1b2a;
    border: 2px solid #0d1b2a;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }

  .shopdev .buy-now-btn:hover {
    background-color: #f4f4f4;
    transform: translateY(-2px);
  }

  .shopdev .buy-now-btn:disabled {
    background-color: #f4f4f4;
    color: #ccc;
    border-color: #ccc;
    cursor: not-allowed;
    transform: none;
  }

  .shopdev .dynamic-checkout {
    margin-top: 12px;
  }

  .shopdev .dynamic-checkout .shopify-payment-button__button {
    border-radius: 6px !important;
  }

  .shopdev .dynamic-checkout .shopify-payment-button__button--unbranded {
    border-radius: 6px !important;
  }

  .shopdev .info-section {
    margin-top: 24px;
    padding: 16px;
    background-color: #f4f4f4;
    border-radius: 6px;
    border-left: 4px solid #0d1b2a;
  }

  .shopdev .info-section-title {
    font-size: 16px;
    font-weight: 600;
    color: #0d1b2a;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .shopdev .info-section-content {
    font-size: 14px;
    color: #333;
    line-height: 1.6;
  }

  .shopdev .confidence-badges {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
    margin-top: 24px;
  }

  @media (min-width: 768px) {
    .shopdev .confidence-badges {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .shopdev .badge {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background-color: #ffffff;
    border: 1px solid #e0e0e0;
    border-radius: 6px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .shopdev .badge:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .shopdev .badge-icon {
    font-size: 24px;
    color: #0d1b2a;
    flex-shrink: 0;
  }

  .shopdev .badge-text {
    font-size: 13px;
    font-weight: 600;
    color: #0d1b2a;
    line-height: 1.3;
  }

  .shopdev .description-section {
    margin-top: 32px;
    border-top: 1px solid #e0e0e0;
    padding-top: 24px;
  }

  .shopdev .description-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    padding: 12px 0;
  }

  .shopdev .description-title {
    font-size: 18px;
    font-weight: 600;
    color: #0d1b2a;
  }

  .shopdev .description-icon {
    font-size: 24px;
    color: #0d1b2a;
    transition: transform 0.3s ease;
    transform: rotate(180deg);
  }

  .shopdev .description-icon.collapsed {
    transform: rotate(0deg);
  }

  .shopdev .description-content {
    max-height: 1000px;
    overflow: hidden;
    transition: max-height 0.3s ease;
  }

  .shopdev .description-content.collapsed {
    max-height: 0;
  }

  .shopdev .description-text {
    padding: 16px 0;
    color: #333;
    line-height: 1.6;
  }

  .shopdev .related-products {
    margin-top: 60px;
    padding-top: 40px;
    border-top: 2px solid #e0e0e0;
  }

  .shopdev .related-products-title {
    font-size: 28px;
    font-weight: 700;
    color: #0d1b2a;
    margin-bottom: 32px;
    text-align: center;
  }

  .shopdev .related-products-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24px;
  }

  @media (min-width: 768px) {
    .shopdev .related-products-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .shopdev .related-product-card {
    background-color: #ffffff;
    border-radius: 6px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .shopdev .related-product-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .shopdev .related-product-image {
    position: relative;
    width: 100%;
    padding-bottom: 100%;
    background-color: #f4f4f4;
    overflow: hidden;
  }

  .shopdev .related-product-image img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .shopdev .related-product-info {
    padding: 16px;
  }

  .shopdev .related-product-title {
    font-size: 16px;
    font-weight: 600;
    color: #0d1b2a;
    margin-bottom: 8px;
    line-height: 1.3;
  }

  .shopdev .related-product-price {
    font-size: 18px;
    font-weight: 700;
    color: #0d1b2a;
  }
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web/src/regular/style.css" />

<div class="w-full">
  <div class="product-page-container">
    {% if product %}
      <div class="product-grid">
        <!-- Image Gallery -->
        <div class="product-images">
          <div class="main-image-container" id="mainImageContainer">
            {% if product.featured_image %}
              <img 
                src="{{ product.featured_image | image_url: width: 800 }}" 
                alt="{{ product.featured_image.alt }}"
                class="main-image"
                id="mainImage"
                oncontextmenu="return false;"
              >
            {% else %}
              {{ 'product-1' | placeholder_svg_tag: 'main-image' }}
            {% endif %}
          </div>

          {% if product.images.size > 1 %}
            <div class="thumbnail-container">
              {% for image in product.images %}
                <div class="thumbnail {% if forloop.first %}active{% endif %}" data-image-url="{{ image | image_url: width: 800 }}">
                  <img 
                    src="{{ image | image_url: width: 100 }}" 
                    alt="{{ image.alt }}"
                    oncontextmenu="return false;"
                  >
                </div>
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <!-- Product Info -->
        <div class="product-info">
          {% if section.settings.show_vendor and product.vendor != blank %}
            <div class="vendor">{{ product.vendor }}</div>
          {% endif %}

          <h2>{{ product.title }}</h2>

          {% if section.settings.show_sku and product.selected_or_first_available_variant.sku != blank %}
            <div class="sku">
              <span class="sku-label">SKU:</span> {{ product.selected_or_first_available_variant.sku }}
            </div>
          {% endif %}

          <div class="price">
            {{ product.price | money }}
          </div>

          {% if product.available %}
            <div class="availability in-stock">In Stock</div>
          {% else %}
            <div class="availability out-of-stock">Out of Stock</div>
          {% endif %}

          <form action="/cart/add" method="post" enctype="multipart/form-data" id="product-form">
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">

            {% if section.settings.show_quantity_selector %}
              <div class="quantity-selector">
                <label class="quantity-label">Quantity:</label>
                <div class="quantity-controls">
                  <button type="button" class="quantity-btn" id="decreaseQty">−</button>
                  <input type="number" name="quantity" value="1" min="1" class="quantity-input" id="quantityInput">
                  <button type="button" class="quantity-btn" id="increaseQty">+</button>
                </div>
              </div>
            {% else %}
              <input type="hidden" name="quantity" value="1">
            {% endif %}

            <div class="button-group">
              <button 
                type="submit" 
                class="add-to-cart-btn"
                {% unless product.available %}disabled{% endunless %}
              >
                {% if product.available %}
                  Add to Cart
                {% else %}
                  Sold Out
                {% endif %}
              </button>

              {% if section.settings.show_buy_now %}
                <button 
                  type="button" 
                  class="buy-now-btn"
                  id="buyNowBtn"
                  {% unless product.available %}disabled{% endunless %}
                >
                  Buy Now
                </button>
              {% endif %}
            </div>

            {% if section.settings.show_dynamic_checkout %}
              <div class="dynamic-checkout">
                {{ form | payment_button }}
              </div>
            {% endif %}
          </form>

          {% if section.settings.show_shipment_info and section.settings.shipment_text != blank %}
            <div class="info-section">
              <div class="info-section-title">
                <i class="ph ph-truck"></i>
                Shipping Information
              </div>
              <div class="info-section-content">
                {{ section.settings.shipment_text }}
              </div>
            </div>
          {% endif %}

          {% if section.settings.show_warranty_info and section.settings.warranty_text != blank %}
            <div class="info-section">
              <div class="info-section-title">
                <i class="ph ph-shield-check"></i>
                Warranty
              </div>
              <div class="info-section-content">
                {{ section.settings.warranty_text }}
              </div>
            </div>
          {% endif %}

          {% if section.settings.show_returns_info and section.settings.returns_text != blank %}
            <div class="info-section">
              <div class="info-section-title">
                <i class="ph ph-arrow-u-up-left"></i>
                Returns Policy
              </div>
              <div class="info-section-content">
                {{ section.settings.returns_text }}
              </div>
            </div>
          {% endif %}

          {% if section.settings.show_confidence_badges %}
            <div class="confidence-badges">
              <div class="badge">
                <i class="ph ph-lock-simple badge-icon"></i>
                <span class="badge-text">Secure Checkout</span>
              </div>
              <div class="badge">
                <i class="ph ph-credit-card badge-icon"></i>
                <span class="badge-text">Safe Payment</span>
              </div>
              <div class="badge">
                <i class="ph ph-arrow-counter-clockwise badge-icon"></i>
                <span class="badge-text">Money-Back Guarantee</span>
              </div>
              <div class="badge">
                <i class="ph ph-headset badge-icon"></i>
                <span class="badge-text">24/7 Support</span>
              </div>
            </div>
          {% endif %}

          <!-- Collapsible Description -->
          <div class="description-section">
            <div class="description-header" id="descriptionHeader">
              <h3 class="description-title">Product Description</h3>
              <i class="ph ph-caret-down description-icon" id="descriptionIcon"></i>
            </div>
            <div class="description-content" id="descriptionContent">
              <div class="description-text">
                {% if product.description != blank %}
                  {{ product.description }}
                {% else %}
                  <p>No description available for this product.</p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Related Products -->
      {% if section.settings.show_related_products %}
        <div class="related-products">
          <h3 class="related-products-title">You May Also Like</h3>
          <div class="related-products-grid">
            {% assign related_products = product.collections.first.products | where_exp: "item", "item.id != product.id" | slice: 0, 3 %}
            {% if related_products.size > 0 %}
              {% for related_product in related_products %}
                <a href="{{ related_product.url }}" class="related-product-card">
                  <div class="related-product-image">
                    {% if related_product.featured_image %}
                      <img 
                        src="{{ related_product.featured_image | image_url: width: 400 }}" 
                        alt="{{ related_product.featured_image.alt }}"
                        loading="lazy"
                      >
                    {% else %}
                      {{ 'product-1' | placeholder_svg_tag }}
                    {% endif %}
                  </div>
                  <div class="related-product-info">
                    <h4 class="related-product-title">{{ related_product.title }}</h4>
                    <div class="related-product-price">{{ related_product.price | money }}</div>
                  </div>
                </a>
              {% endfor %}
            {% else %}
              {% for i in (1..3) %}
                <div class="related-product-card">
                  <div class="related-product-image">
                    {{ 'product-1' | placeholder_svg_tag }}
                  </div>
                  <div class="related-product-info">
                    <h4 class="related-product-title">Related Product {{ i }}</h4>
                    <div class="related-product-price">$0.00</div>
                  </div>
                </div>
              {% endfor %}
            {% endif %}
          </div>
        </div>
      {% endif %}
    {% else %}
      <div style="text-align: center; padding: 60px 20px;">
        <h2 style="color: #0d1b2a; margin-bottom: 16px;">No Product Selected</h2>
        <p style="color: #666;">Please select a product to display on this page.</p>
      </div>
    {% endif %}
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Image Gallery
    const mainImage = document.getElementById('mainImage');
    const thumbnails = document.querySelectorAll('.thumbnail');
    
    thumbnails.forEach(thumbnail => {
      thumbnail.addEventListener('click', function() {
        const imageUrl = this.getAttribute('data-image-url');
        if (mainImage) {
          mainImage.src = imageUrl;
        }
        
        thumbnails.forEach(t => t.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // Prevent image dragging
    const mainImageContainer = document.getElementById('mainImageContainer');
    if (mainImageContainer) {
      mainImageContainer.addEventListener('dragstart', function(e) {
        e.preventDefault();
      });
    }

    {% if section.settings.disable_image_zoom %}
      if (mainImageContainer) {
        mainImageContainer.style.cursor = 'default';
        if (mainImage) {
          mainImage.style.transform = 'none';
        }
      }
    {% endif %}

    // Quantity Selector
    const decreaseBtn = document.getElementById('decreaseQty');
    const increaseBtn = document.getElementById('increaseQty');
    const quantityInput = document.getElementById('quantityInput');

    if (decreaseBtn && increaseBtn && quantityInput) {
      decreaseBtn.addEventListener('click', function() {
        let currentValue = parseInt(quantityInput.value);
        if (currentValue > 1) {
          quantityInput.value = currentValue - 1;
        }
      });

      increaseBtn.addEventListener('click', function() {
        let currentValue = parseInt(quantityInput.value);
        quantityInput.value = currentValue + 1;
      });

      quantityInput.addEventListener('change', function() {
        if (this.value < 1) {
          this.value = 1;
        }
      });
    }

    // Collapsible Description (open by default)
    const descriptionHeader = document.getElementById('descriptionHeader');
    const descriptionContent = document.getElementById('descriptionContent');
    const descriptionIcon = document.getElementById('descriptionIcon');

    if (descriptionHeader && descriptionContent && descriptionIcon) {
      descriptionHeader.addEventListener('click', function() {
        descriptionContent.classList.toggle('collapsed');
        descriptionIcon.classList.toggle('collapsed');
      });
    }

    // Buy Now Button
    const buyNowBtn = document.getElementById('buyNowBtn');
    if (buyNowBtn) {
      buyNowBtn.addEventListener('click', function() {
        const formData = new FormData(productForm);
        
        fetch('/cart/add.js', {
          method: 'POST',
          body: formData
        })
        .then(response => response.json())
        .then(data => {
          window.location.href = '/checkout';
        })
        .catch(error => {
          console.error('Error:', error);
        });
      });
    }

    // Add to Cart Form
    const productForm = document.getElementById('product-form');
    if (productForm) {
      productForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        
        fetch('/cart/add.js', {
          method: 'POST',
          body: formData
        })
        .then(response => response.json())
        .then(data => {
          window.location.href = '/cart';
        })
        .catch(error => {
          console.error('Error:', error);
        });
      });
    }
  });
</script>

{% schema %}
{
  "name": "Soltex Product Page",
  "class": "shopdev",
  "tag": "section",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Product Information"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show vendor",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_sku",
      "label": "Show SKU",
      "default": true
    },
    {
      "type": "header",
      "content": "Purchase Options"
    },
    {
      "type": "checkbox",
      "id": "show_quantity_selector",
      "label": "Show quantity selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_dynamic_checkout",
      "label": "Show dynamic checkout button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_buy_now",
      "label": "Show Buy Now button",
      "default": true
    },
    {
      "type": "header",
      "content": "Additional Information"
    },
    {
      "type": "checkbox",
      "id": "show_shipment_info",
      "label": "Show shipment information",
      "default": true
    },
    {
      "type": "textarea",
      "id": "shipment_text",
      "label": "Shipment information text",
      "default": "Free shipping on orders over $50. Estimated delivery: 3-5 business days."
    },
    {
      "type": "checkbox",
      "id": "show_warranty_info",
      "label": "Show warranty information",
      "default": true
    },
    {
      "type": "textarea",
      "id": "warranty_text",
      "label": "Warranty information text",
      "default": "All products come with a 1-year manufacturer warranty covering defects in materials and workmanship."
    },
    {
      "type": "checkbox",
      "id": "show_returns_info",
      "label": "Show returns policy",
      "default": true
    },
    {
      "type": "textarea",
      "id": "returns_text",
      "label": "Returns policy text",
      "default": "30-day return policy. Items must be unused and in original packaging. Return shipping costs may apply."
    },
    {
      "type": "checkbox",
      "id": "show_confidence_badges",
      "label": "Show confidence badges",
      "default": true
    },
    {
      "type": "header",
      "content": "Image Settings"
    },
    {
      "type": "checkbox",
      "id": "disable_image_zoom",
      "label": "Disable image zoom on hover",
      "default": false
    },
    {
      "type": "header",
      "content": "Related Products"
    },
    {
      "type": "checkbox",
      "id": "show_related_products",
      "label": "Show related products",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Soltex Product Page",
      "settings": {
        "product": "crankshaft-position-ckp",
        "show_vendor": true,
        "show_sku": true,
        "show_quantity_selector": true,
        "show_dynamic_checkout": true,
        "show_buy_now": true,
        "disable_image_zoom": false,
        "show_shipment_info": true,
        "shipment_text": "Free shipping on orders over $50. Estimated delivery: 3-5 business days.",
        "show_warranty_info": true,
        "warranty_text": "All products come with a 1-year manufacturer warranty covering defects in materials and workmanship.",
        "show_returns_info": true,
        "returns_text": "30-day return policy. Items must be unused and in original packaging. Return shipping costs may apply.",
        "show_confidence_badges": true,
        "show_related_products": true
      }
    }
  ]
}
{% endschema %}