<style>
  #shopify-section-{{ section.id }}{
    --bg: {{ section.settings.background_color }};
    --fg: {{ section.settings.text_color }};
    --muted: color-mix(in srgb, {{ section.settings.text_color }} 80%, transparent);
    --card: {% if section.settings.tone == 'light' %}#ffffff{% else %}rgba(255,255,255,.06){% endif %};
    --bd: {% if section.settings.tone == 'light' %}#e5e7eb{% else %}rgba(255,255,255,.18){% endif %};
    --shadow: {% if section.settings.tone == 'light' %}0 10px 24px rgba(15,23,42,.08){% else %}0 10px 24px rgba(0,0,0,.16){% endif %};
    --primary: {{ section.settings.primary_color }};
  }

  #shopify-section-{{ section.id }} .ct-wrap{background:var(--bg);color:var(--fg); position:relative;}
  #shopify-section-{{ section.id }} .inner{max-width: {{ section.settings.container_max }}px; margin:0 auto; padding: clamp(32px,6vw,80px) 16px;}

  #shopify-section-{{ section.id }} .title{
    font: 800 clamp(26px,4vw,40px)/1.15 Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    margin:0 0 8px; text-align: {{ section.settings.header_align }};
  }
  #shopify-section-{{ section.id }} .subtitle{
    font: 400 clamp(15px,2.2vw,18px)/1.65 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    margin:0 0 26px; color: var(--muted); text-align: {{ section.settings.header_align }};
  }

  /* layout */
  #shopify-section-{{ section.id }} .grid{display:grid; gap:18px;}
  @media(min-width:992px){
    #shopify-section-{{ section.id }} .cols-2{grid-template-columns: 1fr 1fr;}
    #shopify-section-{{ section.id }} .cols-3{grid-template-columns: 2fr 1fr;}
  }

  /* cards */
  #shopify-section-{{ section.id }} .card{background:var(--card); border:1px solid var(--bd); border-radius:12px; box-shadow:var(--shadow); padding:18px;}

  /* form */
  #shopify-section-{{ section.id }} .form-grid{display:grid; gap:14px;}
  @media(min-width:768px){ #shopify-section-{{ section.id }} .form-grid.two{grid-template-columns: 1fr 1fr;} }
  #shopify-section-{{ section.id }} .label{font-size:13px; font-weight:600; margin-bottom:6px; display:block;}
  #shopify-section-{{ section.id }} .input, #shopify-section-{{ section.id }} .textarea, #shopify-section-{{ section.id }} .select{
    width:100%; background:#fff; color:#0f172a; border:1px solid #cbd5e1; border-radius:10px; padding:12px 14px; font-size:16px;
  }
  {% if section.settings.tone == 'dark' %}
  #shopify-section-{{ section.id }} .input, #shopify-section-{{ section.id }} .textarea, #shopify-section-{{ section.id }} .select{
    background:rgba(255,255,255,.9);
  }
  {% endif %}
  #shopify-section-{{ section.id }} .textarea{min-height:130px; resize:vertical;}
  #shopify-section-{{ section.id }} .consent{display:flex; gap:10px; align-items:flex-start; font-size:13px; color:var(--muted);}
  #shopify-section-{{ section.id }} .btn{
    display:inline-block; padding:12px 18px; border-radius:10px; border:1px solid var(--bd);
    background: var(--primary); color:#fff; font-weight:700; text-decoration:none; cursor:pointer;
  }
  #shopify-section-{{ section.id }} .btn[disabled]{opacity:.6; cursor:not-allowed;}
  #shopify-section-{{ section.id }} .msg{padding:12px 14px; border-radius:10px; margin-bottom:12px; font-size:14px;}
  #shopify-section-{{ section.id }} .msg.ok{background:#ecfdf5; border:1px solid #10b981; color:#065f46;}
  #shopify-section-{{ section.id }} .msg.err{background:#fef2f2; border:1px solid #ef4444; color:#991b1b;}

  /* info */
  #shopify-section-{{ section.id }} .info-list{list-style:none; padding:0; margin:0; display:grid; gap:10px;}
  #shopify-section-{{ section.id }} .info-list a{color:var(--fg); text-decoration:none;}
  #shopify-section-{{ section.id }} .info-list a:hover{text-decoration:underline;}
  #shopify-section-{{ section.id }} .map-wrap{border-radius:12px; overflow:hidden; border:1px solid var(--bd); box-shadow:var(--shadow);}
</style>

<section class="ct-wrap" aria-label="Contáctanos">
  <div class="inner">
    {% if section.settings.title != blank %}<h1 class="title">{{ section.settings.title | escape }}</h1>{% endif %}
    {% if section.settings.subtitle != blank %}<p class="subtitle">{{ section.settings.subtitle }}</p>{% endif %}

    <div class="grid cols-3">
      <!-- FORM -->
      <div class="card">
        {% form 'contact', id: 'contact-form-'.concat(section.id), class: 'contact-form' %}
          <input type="hidden" name="contact[tags]" value="contact_form,soltex">
          {% if form.posted_successfully? %}
            <div class="msg ok" role="status">{{ section.settings.success_message }}</div>
          {% endif %}
          {% if form.errors %}
            <div class="msg err" role="alert">{{ section.settings.error_message }}</div>
          {% endif %}

          <div class="form-grid two">
            {% if section.settings.show_name %}
              <div>
                <label class="label" for="ct-name-{{ section.id }}">{{ section.settings.name_label }}</label>
                <input class="input" id="ct-name-{{ section.id }}" type="text" name="contact[name]" placeholder="{{ section.settings.name_ph }}" {% if section.settings.name_required %}required{% endif %}>
              </div>
            {% endif %}

            <div>
              <label class="label" for="ct-email-{{ section.id }}">{{ section.settings.email_label }}</label>
              <input class="input" id="ct-email-{{ section.id }}" type="email" name="contact[email]" placeholder="{{ section.settings.email_ph }}" required>
            </div>

            {% if section.settings.show_phone %}
              <div>
                <label class="label" for="ct-phone-{{ section.id }}">{{ section.settings.phone_label }}</label>
                <input class="input" id="ct-phone-{{ section.id }}" type="tel" name="contact[phone]" placeholder="{{ section.settings.phone_ph }}">
              </div>
            {% endif %}

            {% if section.settings.show_company %}
              <div>
                <label class="label" for="ct-company-{{ section.id }}">{{ section.settings.company_label }}</label>
                <input class="input" id="ct-company-{{ section.id }}" type="text" name="contact[company]" placeholder="{{ section.settings.company_ph }}">
              </div>
            {% endif %}
          </div>

          {% if section.settings.show_subject %}
            <div style="margin-top:10px">
              <label class="label" for="ct-subject-{{ section.id }}">{{ section.settings.subject_label }}</label>
              <input class="input" id="ct-subject-{{ section.id }}" type="text" name="contact[subject]" placeholder="{{ section.settings.subject_ph }}">
            </div>
          {% endif %}

          <div style="margin-top:10px">
            <label class="label" for="ct-message-{{ section.id }}">{{ section.settings.message_label }}</label>
            <textarea class="textarea" id="ct-message-{{ section.id }}" name="contact[body]" placeholder="{{ section.settings.message_ph }}" required></textarea>
          </div>

          {% if section.settings.show_consent %}
            <p class="consent" style="margin-top:8px">
              <input type="checkbox" id="ct-consent-{{ section.id }}" required>
              <label for="ct-consent-{{ section.id }}">{{ section.settings.consent_text }}</label>
            </p>
          {% endif %}

          <div class="honeypot" aria-hidden="true" style="position:absolute;left:-9999px">
            <label for="ct-hp-{{ section.id }}">Do not fill</label>
            <input id="ct-hp-{{ section.id }}" type="text" name="contact[hp]" tabindex="-1" autocomplete="off">
          </div>

          <div style="margin-top:12px">
            <button class="btn" type="submit" id="ct-submit-{{ section.id }}">{{ section.settings.button_label }}</button>
          </div>
        {% endform %}
      </div>

      <!-- INFO / SIDEBAR -->
      <aside class="card" aria-label="Información de contacto">
        {% if section.settings.info_title != blank %}<h3 style="margin:0 0 8px; font:800 16px/1.2 Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif">{{ section.settings.info_title | escape }}</h3>{% endif %}
        <ul class="info-list">
          {% if section.settings.address_line_1 != blank %}<li>{{ section.settings.address_line_1 }}</li>{% endif %}
          {% if section.settings.address_line_2 != blank %}<li>{{ section.settings.address_line_2 }}</li>{% endif %}
          {% if section.settings.phone_text != blank and section.settings.phone_url != blank %}<li><a href="{{ section.settings.phone_url }}">{{ section.settings.phone_text }}</a></li>{% endif %}
          {% if section.settings.email_text != blank and section.settings.email_url != blank %}<li><a href="{{ section.settings.email_url }}">{{ section.settings.email_text }}</a></li>{% endif %}
          {% if section.settings.hours_text != blank %}<li>{{ section.settings.hours_text }}</li>{% endif %}
        </ul>

        {% if section.settings.show_social %}
          <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
            {% if section.settings.facebook_url != blank %}<a href="{{ section.settings.facebook_url }}">Facebook</a>{% endif %}
            {% if section.settings.instagram_url != blank %}<a href="{{ section.settings.instagram_url }}">Instagram</a>{% endif %}
            {% if section.settings.linkedin_url != blank %}<a href="{{ section.settings.linkedin_url }}">LinkedIn</a>{% endif %}
            {% if section.settings.whatsapp_url != blank %}<a href="{{ section.settings.whatsapp_url }}">WhatsApp</a>{% endif %}
          </div>
        {% endif %}
      </aside>
    </div>

    {% if section.settings.show_map and section.settings.map_embed != blank %}
      <div style="margin-top:18px" class="map-wrap">
        {{ section.settings.map_embed }}
      </div>
    {% endif %}
  </div>
</section>

<script>
  (function(){
    var root = document.getElementById('shopify-section-{{ section.id }}');
    if(!root) return;
    var form = root.querySelector('form.contact-form');
    var btn  = root.querySelector('#ct-submit-{{ section.id }}');
    var hp   = root.querySelector('#ct-hp-{{ section.id }}');
    if(!form) return;
    form.addEventListener('submit', function(e){
      if(hp && hp.value) { e.preventDefault(); return false; }
      if(btn){ btn.disabled = true; btn.textContent = '{{ section.settings.button_loading }}'; }
    });
  })();
</script>

{% schema %}
{
  "name": "soltex-contact",
  "settings": [
    { "type": "select", "id": "tone", "label": "Tono", "options": [
      { "value": "light", "label": "Claro" }, { "value": "dark", "label": "Oscuro" }
    ], "default": "light" },

    { "type": "range", "id": "container_max", "label": "Ancho máximo (px)", "min": 900, "max": 1400, "step": 50, "default": 1100 },
    { "type": "color", "id": "background_color", "label": "Color de fondo", "default": "#f8fafc" },
    { "type": "color", "id": "text_color", "label": "Color de texto", "default": "#0d1b2a" },
    { "type": "color", "id": "primary_color", "label": "Color botón (primario)", "default": "#0d1b2a" },

    { "type": "text", "id": "title", "label": "Título", "default": "Contáctanos" },
    { "type": "text", "id": "subtitle", "label": "Subtítulo", "default": "Estamos listos para ayudarte." },
    { "type": "select", "id": "header_align", "label": "Alineación del encabezado", "options": [
      { "value": "left", "label": "Izquierda" }, { "value": "center", "label": "Centrado" }
    ], "default": "center" },

    { "type": "checkbox", "id": "show_name", "label": "Mostrar campo Nombre", "default": true },
    { "type": "text", "id": "name_label", "label": "Etiqueta Nombre", "default": "Nombre completo" },
    { "type": "text", "id": "name_ph", "label": "Placeholder Nombre", "default": "Tu nombre" },
    { "type": "checkbox", "id": "name_required", "label": "Nombre requerido", "default": false },

    { "type": "text", "id": "email_label", "label": "Etiqueta Email", "default": "Email" },
    { "type": "text", "id": "email_ph", "label": "Placeholder Email", "default": "tu@email.com" },

    { "type": "checkbox", "id": "show_phone", "label": "Mostrar Teléfono", "default": true },
    { "type": "text", "id": "phone_label", "label": "Etiqueta Teléfono", "default": "Teléfono" },
    { "type": "text", "id": "phone_ph", "label": "Placeholder Teléfono", "default": "+52 ..." },

    { "type": "checkbox", "id": "show_company", "label": "Mostrar Empresa", "default": true },
    { "type": "text", "id": "company_label", "label": "Etiqueta Empresa", "default": "Empresa" },
    { "type": "text", "id": "company_ph", "label": "Placeholder Empresa", "default": "SOLTEX S.A." },

    { "type": "checkbox", "id": "show_subject", "label": "Mostrar Asunto", "default": false },
    { "type": "text", "id": "subject_label", "label": "Etiqueta Asunto", "default": "Asunto" },
    { "type": "text", "id": "subject_ph", "label": "Placeholder Asunto", "default": "Cotización, Soporte, etc." },

    { "type": "text", "id": "message_label", "label": "Etiqueta Mensaje", "default": "Mensaje" },
    { "type": "text", "id": "message_ph", "label": "Placeholder Mensaje", "default": "Cuéntanos qué necesitas…" },

    { "type": "checkbox", "id": "show_consent", "label": "Mostrar consentimiento (GDPR)", "default": false },
    { "type": "textarea", "id": "consent_text", "label": "Texto de consentimiento" },

    { "type": "textarea", "id": "success_message", "label": "Mensaje de éxito", "default": "Gracias por tu mensaje. Te contactaremos pronto." },
    { "type": "textarea", "id": "error_message", "label": "Mensaje de error", "default": "Ups, revisa los campos e inténtalo de nuevo." },
    { "type": "text", "id": "button_label", "label": "Texto del botón", "default": "Enviar mensaje" },
    { "type": "text", "id": "button_loading", "label": "Texto cargando", "default": "Enviando…" },

    { "type": "header", "content": "Información lateral" },
    { "type": "text", "id": "info_title", "label": "Título info", "default": "Información de contacto" },
    { "type": "text", "id": "address_line_1", "label": "Dirección línea 1" },
    { "type": "text", "id": "address_line_2", "label": "Dirección línea 2" },
    { "type": "text", "id": "phone_text", "label": "Teléfono/WhatsApp (texto)" },
    { "type": "url",  "id": "phone_url",  "label": "Teléfono/WhatsApp (URL)" },
    { "type": "text", "id": "email_text", "label": "Email (texto)" },
    { "type": "url",  "id": "email_url",  "label": "Email (mailto:)" },
    { "type": "text", "id": "hours_text", "label": "Horario" },

    { "type": "checkbox", "id": "show_social", "label": "Mostrar redes", "default": true },
    { "type": "url", "id": "facebook_url", "label": "Facebook" },
    { "type": "url", "id": "instagram_url", "label": "Instagram" },
    { "type": "url", "id": "linkedin_url", "label": "LinkedIn" },
    { "type": "url", "id": "whatsapp_url", "label": "WhatsApp" },

    { "type": "checkbox", "id": "show_map", "label": "Mostrar mapa (embed)", "default": false },
    { "type": "textarea", "id": "map_embed", "label": "Código embed del mapa (iframe)" }
  ],
  "presets": [{ "name": "soltex-contact" }]
}
{% endschema %}
